<?xml version="1.0" encoding="UTF-8"?>
 <!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"   
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper  namespace="com.mic.dao.atendnc.TeacherAtendncDao">
  <!-- 得到考勤id 得不到即为没有考勤 -->
  		<select id="getAtendncID"  parameterType="Integer"  resultType="Integer"> 
  				SELECT
					id
				FROM
					attendance
				WHERE
					course_note_id = #{noteId};
  		</select>
  		
  		<!-- 通过考勤id拿到考情信息 -->
  		<select id="getAMsg"  parameterType="Integer"  resultType="com.mic.bean.departments.Information">
	  			SELECT
					student_id,
					status
				FROM
					information
				WHERE
					attendance_id = #{atendncId}
  		</select>
  		<!-- 拿到全部选了这门课的学生的id -->
  		<select id="getStuIdList" parameterType="Integer"  resultType="Integer">
  				SELECT
					student_id
				FROM	
					elective
				WHERE
					course_id = (
						SELECT
							course_id
						FROM
							course_note 
						WHERE
							id = #{noteId}
					)
  		</select>
  		<!-- 通过课堂id拿到课堂时间信息  -->
  		<select id="getTimeMsg" parameterType="Integer" resultType="com.mic.bean.course.CourseNote">
	  			SELECT
					begin_time,
					end_time
				FROM	
					course_note
				WHERE
					id = #{noteId}
  		</select>
  		<!-- 新建考勤 -->
  		<insert id="addAtendnc" parameterType="com.mic.bean.atendnc.Attendance" 
  				flushCache="true" useGeneratedKeys="true" keyProperty="id"> 
  			INSERT 
			INTO attendance(
				course_note_id,
				time,
				classroom,
				state
			)VALUES(
				#{course_note_id},
				#{time},
				#{classroom},
				#{state}
			)
  		</insert>
  </mapper>